#!/bin/bash

# -------------------------------------
# ğŸš€ Auto WiFi Recon Script for Kali Linux
# -------------------------------------

# ConfiguraciÃ³n inicial
iface="wlan1"
scan_duration=60  # Tiempo de escaneo en segundos (1 minuto)

echo "âš¡ï¸ Iniciando Reconocimiento de Redes WiFi con la Interfaz: $iface"

# 1. Poner la interfaz en modo monitor
echo "ğŸ”„ Activando modo monitor en $iface..."
sudo ip link set $iface down
sudo iw dev $iface set type monitor
sudo ip link set $iface up

# 2. Cambiar la MAC para evitar detecciÃ³n
echo "ğŸ”„ Cambiando MAC para anonimato..."
sudo macchanger -r $iface

# 3. Ejecutar airodump-ng durante 1 minuto
echo "ğŸ” Escaneando redes WiFi durante $scan_duration segundos..."
sudo timeout ${scan_duration}s airodump-ng $iface --write wifi_recon --output-format csv

# Verificar si el archivo se generÃ³ correctamente
if [[ -f wifi_recon-01.csv ]]; then
    echo "âœ… Escaneo con airodump-ng completado. Resultados:"
    cat wifi_recon-01.csv
else
    echo "âŒ Error: No se generÃ³ el archivo de resultados de airodump-ng."
fi

# 4. Ejecutar bettercap durante 1 minuto
echo "ğŸ•µï¸ Ejecutando bettercap para escaneo profundo..."
sudo timeout ${scan_duration}s bettercap -iface $iface -eval "net.probe on; net.recon on; sleep 10; net.show"

# Verificar si bettercap tuvo Ã©xito
if [ $? -eq 0 ]; then
    echo "âœ… Bettercap finalizÃ³ correctamente."
else
    echo "âŒ Error: Bettercap no pudo ejecutarse correctamente. Verifica la interfaz o los permisos."
fi

# 5. Restaurar la interfaz a modo managed
echo "ğŸ”„ Restaurando interfaz $iface a modo managed..."
sudo ip link set $iface down
sudo iw dev $iface set type managed
sudo ip link set $iface up

echo "âœ… Proceso de reconocimiento finalizado."
